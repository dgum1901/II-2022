---
title: "Ejercicios Modelos"
author: "Maria Jose Corea"
date: "2022-10-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

 # Ejercicio 2.16 
 Un estudio de bebés planteó la hipótesis de que los bebés tardarían más en
aprender a gatear en los meses más fríos porque la ropa extra restringe su
movimiento. Entre 1988 y 1991, la primera edad de gateo de los bebés y el promedio
se registró la temperatura mensual seis meses después del nacimiento (cuando “los bebés presumiblemente entran en la ventana de preparación locomotora”; p. 72). Los padres
informaron el mes de nacimiento y la edad en que su bebé se arrastró o gateó por primera vez
distancia de cuatro pies en un minuto. Los datos fueron recolectados en la Universidad de
Denver Infant Study Center sobre 208 niños y 206 niñas, y resumido por
el mes de nacimiento (Tabla 2.10; conjunto de datos: rastreo).
1. Trazar los datos. ¿Qué suposiciones, si las hubiere, parecen violarse?
2. Explique por qué un modelo de regresión ponderado es apropiado para los datos.
3. Ajuste un modelo de regresión lineal ponderado a los datos e interprete el
coeficientes de regresión.
4. Probar formalmente la hipótesis propuesta por los investigadores.
5. Encuentre un intervalo de confianza del 90 % para la pendiente de la línea ajustada, y
interpretar.
6. Ajuste el modelo de regresión no ponderado, luego trace ambas líneas de regresión en
una trama de los datos. Comenta las diferencias.
7. Calcule los intervalos de confianza del 95 % para los valores ajustados de la
línea de regresión ponderada, y también grafíquelos.
8. Interpreta el modelo.

```{r}
Babies <- read.csv("~/GitHub/II-2022/Modelos Lineales/Base.txt")
colnames(Babies) <- c('Mes','PromedioSemanas','TamMuestra','PromedioTemperatura')

```

1.R\
grafique los datos. ¿Qué suposiciones, si las hubiere, parecen violarse?

```{r}

p <- lm(PromedioSemanas ~ PromedioTemperatura, data=Babies)

plot( PromedioSemanas ~ PromedioTemperatura, data=Babies, las=1,
      xlab = "Promedio Temperatura", ylab = "Promedio semanas" )
abline(coef(p), lty = 1, lwd = 2)

```

2.R\
Explique por qué un modelo de regresión ponderado es apropiado para los datos.

Porque la regresión ponderada se puede utilizar para corregir la heterocedasticidad. En un procedimiento de regresión ponderada, se otorga más peso a las observaciones con una varianza más pequeña porque estas observaciones brindan información más confiable sobre la función de regresión que aquellas con varianzas grandes. Observemos que la varianza de las observaciones, asimismo la desviación estándar y un histograma para ver si se ve normalidad.


3.R/
Ajuste un modelo de regresión lineal ponderado a los datos e interprete los coeficientes de regresión.

```{r}

q <-  lm(PromedioSemanas ~ PromedioTemperatura, data=Babies, weights = TamMuestra)

plot( PromedioSemanas ~ PromedioTemperatura, data=Babies, las=1,
      xlab = "Promedio Temperatura", ylab = "Promedio semanas" )
abline(coef(p), lty = 1, lwd = 2)
abline(coef(q), lty = 2, lwd = 2)
```
Note que con el ajuste por pesos, la curva se eleva un poco, a grandes rasgos no hay una gran diferencia y el análisis es que dado un aumento en una unidad de temperatura, que es unica covariable y provoca una disminucuion de mas 0.75 en promedio en la edad promedio de gateo, amnteniendo las demás variables constante. Un unidad de la tempratura sube, indica que el promedio de la edad promedio baja en o.075, nomina lmente, funcio de enlacio que es la identidad.
Un aumento de la temperatura proboca una disminucion de apro de 0.075 en promedio de la edad promedio,  como estamps viedno la esperanza, que estamos viendo mu, que es la esperanza de Y.

Es importante ver que al menos sale negativo el coeficiente, que es lo que espera el estudio,puesto que tienen una relación negativa.


4.R/
Probar formalmente la hipótesis propuesta por los investigadores.

```{r}
summary(q)
```

Los valores son un poco alarmantes, sin embargo, se rechaza la hipótesis nula con un nivel de confianza superor al 95%, con una significancia considerable, sin embargo, la temperatura solo explica un 43% de la variabilidad de las semanas se explica con la temperatura.



5.R/
Encuentre un intervalo de confianza del 90% para la pendiente de la línea ajustada e interprete.
```{r}
confint(q, level = 0.9)
```
Lo anterior indica que el intervalo de confianza para el coeficiente del promedio de temperatura al 90% se encuentra entre -0.1200823 y -0.03113231 en el modelo ajustado por pesos. Esto es que el 90% de las veces, casi seguramente, el coeficiente de la varaible se va a encontrar en ese intervalo.


6. R/ 
Ajuste el modelo de regresión no ponderado, luego trace ambas líneas de regresión en una gráfica de los datos. Comenta las diferencias

Ya se habia hecho:
```{r}
plot( PromedioSemanas ~ PromedioTemperatura, data=Babies, las=1,
      xlab = "Promedio Temperatura", ylab = "Promedio semanas" )
abline(coef(p), lty = 1, lwd = 2)
abline(coef(q), lty = 2, lwd = 2)
```

7.R/
Calcule los intervalos de confianza del 95 % para los valores ajustados de la línea de regresión ponderada y también grafíquelos.

```{r}
cosa <- confint(q)
x <- Babies$PromedioTemperatura
x <-(PromedioTemperatura = seq(min(x), max(x), by = 0.05))
cosa <-
  predict(q,
          newdata = data.frame(x),
          interval = "confidence",
          level = 0.95)


plot( PromedioSemanas ~ PromedioTemperatura, data=Babies,
      xlab = "Promedio Temperatura", ylab = "Promedio semanas")
abline(coef(q), lty = 1, lwd = 2)
lines(x, cosa[,2], col="blue", lty=2)
lines(x, cosa[,3], col="blue", lty=2)

```
8.R/
Interprete el modelo

Se interpreta que en el modelo existe una relación lineal entre el aumento de la temperatura media y la disminución de la edad media de gateo. La variable es estadísticamente significativa.


# Ejercicio 
