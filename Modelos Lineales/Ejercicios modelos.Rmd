---
title: "Ejercicios Modelos"
author: "Maria Jose Corea"
date: "2022-10-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

2.16 Un estudio de bebés planteó la hipótesis de que los bebés tardarían más en
aprender a gatear en los meses más fríos porque la ropa extra restringe su
movimiento. Entre 1988 y 1991, la primera edad de gateo de los bebés y el promedio
se registró la temperatura mensual seis meses después del nacimiento (cuando “los bebés presumiblemente entran en la ventana de preparación locomotora”; p. 72). Los padres
informaron el mes de nacimiento y la edad en que su bebé se arrastró o gateó por primera vez
distancia de cuatro pies en un minuto. Los datos fueron recolectados en la Universidad de
Denver Infant Study Center sobre 208 niños y 206 niñas, y resumido por
el mes de nacimiento (Tabla 2.10; conjunto de datos: rastreo).
1. Trazar los datos. ¿Qué suposiciones, si las hubiere, parecen violarse?
2. Explique por qué un modelo de regresión ponderado es apropiado para los datos.
3. Ajuste un modelo de regresión lineal ponderado a los datos e interprete el
coeficientes de regresión.
4. Probar formalmente la hipótesis propuesta por los investigadores.
5. Encuentre un intervalo de confianza del 90 % para la pendiente de la línea ajustada, y
interpretar.
6. Ajuste el modelo de regresión no ponderado, luego trace ambas líneas de regresión en
una trama de los datos. Comenta las diferencias.
7. Calcule los intervalos de confianza del 95 % para los valores ajustados de la
línea de regresión ponderada, y también grafíquelos.
8. Interpreta el modelo.

```{r}
Babies <- read.csv("~/GitHub/II-2022/Modelos Lineales/Base.txt")

colnames(Babies) <- c('Mes', 'PromedioSemanas','Frecuencia', 'PromedioTemperatura')


```

1.R\

```{r}
qqnorm(Babies$PromedioTemperatura, pch = 1, frame = FALSE)
qqline(Babies$PromedioTemperatura, col = "steelblue", lwd = 2)


p <- lm(PromedioSemanas ~ PromedioTemperatura, data=Babies)

plot( PromedioSemanas ~ PromedioTemperatura, data=Babies, las=1,
xlab="Promedio Temperatura", ylab="Promedio semanas" )
abline( coef(p), lty=1, lwd=2)
```
Al realizar la comparación del promedio de semanas hasta gatear y el rpomedio de la temperatura en los siguientes 6 meses, se puede observar una relativa linealidad decreciente, es decir, que en cuanto más frío esté, menos son los reportes de que los niños gateen. Y se encuentra un outlyer entre 50 y 60.

2.R\

Porque la regresión ponderada se puede utilizar para corregir la heterocedasticidad. En un procedimiento de regresión ponderada, se otorga más peso a las observaciones con una varianza más pequeña porque estas observaciones brindan información más confiable sobre la función de regresión que aquellas con varianzas grandes. Observemos que la varianza de las observaciones, asimismo la desviación estándar y un histograma para ver si se ve normalidad.

```{r}
var(Babies$PromedioTemperatura)
sd(Babies$PromedioTemperatura)
hist(Babies$PromedioTemperatura, breaks = 12)
```
3.R/

```{r}
mod_ols <- lm(Babies$PromedioTemperatura~ Babies$PromedioSemanas + I(Babies$PromedioSemanas^2))  #Modelo de mínimos cuadrados ordinarios

mod_pond <-
  lm(
    I(sqrt(Babies$Frecuencia) * Babies$PromedioTemperatura) ~ 0 + sqrt(Babies$Frecuencia) + I(sqrt(Babies$Frecuencia) * Babies$PromedioSemanas) + I(sqrt(Babies$Frecuencia) *
                                                                                                                                                      Babies$PromedioSemanas ^ 2)
  )

mod_leo <-  lm(PromedioSemanas ~ PromedioTemperatura, data=Babies, weights = Frecuencia)

coef(mod_leo)
```

```{r}
coef(mod_ols)
coef(mod_pond)
```

Se puede notar la diferencia en los coeficientes, o sea son modelos distintos
```{r}
summary(mod_pond)
```


El modelo es bastante significativo